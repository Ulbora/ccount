<html>

<head>
    <meta charset="utf-8">
    <title>Calory Counter</title>
    <meta charset="utf-8" />
    <meta name="Description" content="A WebAssembly calory counting app written in rust" />
    <meta name="keywords" content="WebAssembly, rust, C++, iPhone, Android, Mobile">
    <meta name="author" content="Ken Williamson, Ulbora Labs LLC">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <script type='text/javascript' src="/libs/js/popper.js"></script>
    <script type='text/javascript' src="/libs/js/jquery-3.5.1.min.js"></script>
    <script type='text/javascript' src="/libs/js/bootstrap.min.js"></script>
    <script type='text/javascript' src="/js/custom.js"></script>

    <link rel="stylesheet" href="/libs/css/bootstrap.min.css">
    <link rel="stylesheet" href="/libs/css/bootstrap-grid.min.css">
    <link rel="stylesheet" href="/libs/css/bootstrap-reboot.min.css">
    <link rel="stylesheet" href="/css/style.css">
</head>

<body>
    <!-- Note the usage of `type=module` here as this is an ES6 module -->
    <script type="module">
        // Use ES module import syntax to import functionality from the module
        // that we have compiled.
        //
        // Note that the `default` import is an initialization function which
        // will "boot" the module and make it ready to use. Currently browsers
        // don't support natively imported WebAssembly as an ES module, but
        // eventually the manual initialization won't be required!
        import init, { get_calories_by_day, get_food_by_day, login, user_login } from './ccount.js';

        async function run() {
            // First up we need to actually load the wasm file, so we use the
            // default export to inform it where the wasm file is located on the
            // server, and then we wait on the returned promise to wait for the
            // wasm to be loaded.
            //
            // It may look like this: `await init('./pkg/without_a_bundler_bg.wasm');`,
            // but there is also a handy default inside `init` function, which uses
            // `import.meta` to locate the wasm file relatively to js file.
            //
            // Note that instead of a string you can also pass in any of the
            // following things:
            //
            // * `WebAssembly.Module`
            //
            // * `ArrayBuffer`
            //
            // * `Response`
            //
            // * `Promise` which returns any of the above, e.g. `fetch("./path/to/wasm")`
            //
            // This gives you complete control over how the module is loaded
            // and compiled.
            //
            // Also note that the promise, when resolved, yields the wasm module's
            // exports which is the same as importing the `*_bg` module in other
            // modes
            await init();
            setCaloriesByDay(get_calories_by_day);
            setFoodByDay(get_food_by_day);
            setLogin(login);
            setLoginUser(user_login);

            // And afterwards we can use all the functionality defined in wasm.
            //const result = get_calories_by_day("ken");
            //get_calories_by_day("ken");
            //console.log(`1 + 2 = ${result}`);
            //if (result !== 3)
            //throw new Error("wasm addition doesn't work!");

        }

        run();
    </script>

    <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" onclick="getCaloriesByDay()" href="#">
            <img src="favicon.ico" width="30" height="30" alt="">
        </a>

        <ul class="nav">

            <li class="nav-item">
                <a href="#" class="nav-link" style="color: ghostwhite;" onclick="getCalories()"
                    role="button">Calories</a>
            </li>

            <li class="nav-item">
                <a href="#" class="nav-link" style="color: ghostwhite;" onclick="getFoodByDay()">Food</a>
            </li>

            <li class="nav-item">
                <a href="#" class="nav-link" style="color: ghostwhite;" onclick="loginScreen()">Login</a>
            </li>

        </ul>

    </nav>

    <div id="cont" style="margin: 5% 0 0 0;">

    </div>

</body>

</html>